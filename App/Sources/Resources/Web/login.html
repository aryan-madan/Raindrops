<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Raindrops</title>
    <style>
        :root {
            --bg: #F2F2F7;
            --card: #FFFFFF;
            --text: #000000;
            --muted: #8E8E93;
            --border: #C6C6C8;
            --focus: #007AFF;
            --font: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #000000;
                --card: #1C1C1E;
                --text: #FFFFFF;
                --muted: #8E8E93;
                --border: #38383A;
            }
        }

        body {
            margin: 0;
            min-height: 100dvh;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: var(--font);
            background: var(--bg);
            color: var(--text);
            -webkit-font-smoothing: antialiased;
        }

        .container {
            width: 100%;
            max-width: 320px;
            padding: 20px;
            text-align: center;
        }

        .logo {
            width: 48px;
            height: 48px;
            margin-bottom: 24px;
        }

        h1 {
            font-size: 22px;
            font-weight: 600;
            margin: 0 0 8px 0;
        }

        p {
            font-size: 15px;
            color: var(--muted);
            margin: 0 0 32px 0;
            line-height: 1.4;
        }

        .pin-wrap {
            position: relative;
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .real-input {
            position: absolute;
            inset: 0;
            opacity: 0;
            font-size: 24px;
            letter-spacing: 1em;
            height: 100%;
            cursor: pointer;
        }

        .box {
            width: 48px;
            height: 56px;
            border: 1px solid var(--border);
            border-radius: 12px;
            background: var(--card);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 500;
            transition: 0.2s;
        }

        .real-input:focus~.box.active {
            border-color: var(--focus);
            box-shadow: 0 0 0 1px var(--focus);
        }

        .error {
            color: #FF3B30;
            font-size: 13px;
            margin-top: 24px;
            min-height: 20px;
            font-weight: 500;
        }
    </style>
</head>

<body>
    <div class="container">
        <img src="/logo" class="logo" alt="R">
        <h1>Welcome</h1>
        <p>Enter the 4-digit PIN to continue.</p>

        <form method="POST" action="/login" id="form">
            <div class="pin-wrap">
                <input type="tel" name="pin" class="real-input" id="input" maxlength="4" autocomplete="off" autofocus>
                <div class="box" id="b1"></div>
                <div class="box" id="b2"></div>
                <div class="box" id="b3"></div>
                <div class="box" id="b4"></div>
            </div>
            <div class="error">{{ERROR}}</div>
        </form>
    </div>

    <script>
        const input = document.getElementById('input');
        const boxes = [
            document.getElementById('b1'),
            document.getElementById('b2'),
            document.getElementById('b3'),
            document.getElementById('b4')
        ];

        function update() {
            const val = input.value;
            boxes.forEach((b, i) => {
                b.innerText = val[i] || '';
                if (i === val.length) b.classList.add('active');
                else b.classList.remove('active');
            });
            if (val.length === 4) document.getElementById('form').submit();
        }

        input.addEventListener('input', update);
        update();

        document.querySelector('.pin-wrap').addEventListener('click', () => input.focus());
    </script>
</body>

</html>